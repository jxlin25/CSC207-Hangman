@startuml RoomJoinWorkflow

title Room Join Workflow

skinparam nodesep 10
skinparam ranksep 50

actor "User" as user

rectangle "View Layer" {
  component "RoomJoinView" as roomView
}

rectangle "Interface Adapter Layer" {
  component "RoomJoinController" as controller
  component "RoomJoinPresenter" as presenter
  component "RoomJoinViewModel" as joinVM
  component "LobbyViewModel" as lobbyVM
  component "ViewManagerModel" as viewManager
}

rectangle "Use Case Layer" {
  component "RoomJoinInteractor" as interactor
  component "RoomJoinInputData" as inputData
  component "RoomJoinOutputData" as outputData
}

rectangle "Framework Layer" {
  component "HangmanClient" as client
}

' Vertical layout - top to bottom flow
user -> roomView : enters username & roomId
user -> roomView : clicks "Join Room"

roomView -> controller : execute(username, roomId)

controller -> interactor : execute(inputData)

interactor -> inputData : **create** with username, roomId

interactor -> client : joinRoom(roomId, username)

client --> interactor : success = true

interactor -> outputData : **create** with roomId, players

interactor -> presenter : prepareSuccessView(outputData)

presenter -> lobbyVM : setRoomId(roomId)
presenter -> lobbyVM : setPlayers(players)
presenter -> lobbyVM : firePropertyChanged()

presenter -> viewManager : setActiveView("lobby")
presenter -> viewManager : firePropertyChanged()

lobbyVM -> roomView : propertyChange event\n(switch to lobby)

viewManager -> roomView : propertyChange event\n(view change)

' Error Flow
interactor -> presenter : prepareFailView("Room full")

presenter -> joinVM : setError("Room full")
presenter -> joinVM : firePropertyChanged()

joinVM -> roomView : propertyChange event\n(show error)

@enduml